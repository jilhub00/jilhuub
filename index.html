<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>jillStream — Video Platform</title>
<link rel="icon" href="data:," />
<style>
  :root{
    --bg:#0f1720;
    --card:#0b1220;
    --muted:#9aa6b2;
    --accent:#06b6d4;
    --glass: rgba(255,255,255,0.03);
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,"Helvetica Neue",Arial;background:linear-gradient(180deg,#071025 0%, #071a2a 100%);color:#e6eef6}
  header{
    display:flex;gap:16px;align-items:center;padding:18px 20px;border-bottom:1px solid rgba(255,255,255,0.03);
    position:sticky;top:0;background:linear-gradient(90deg, rgba(2,6,23,0.5), rgba(2,6,23,0.35));
    backdrop-filter: blur(6px);z-index:50;
  }
  .brand{display:flex;align-items:center;gap:12px}
  .logo{
    width:44px;height:44px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#7c3aed);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:18px;color:#042027;
  }
  h1{margin:0;font-size:18px;line-height:1}
  .search{
    margin-left:auto;display:flex;gap:8px;align-items:center;
  }
  .search input{
    width:260px;max-width:40vw;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);
    background:var(--glass);color:inherit;outline:none;
  }
  .container{max-width:1180px;margin:22px auto;padding:0 18px}
  .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px}
  .card{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:12px;overflow:hidden;border:1px solid rgba(255,255,255,0.03);
    box-shadow: 0 6px 18px rgba(2,6,23,0.6);
    display:flex;flex-direction:column;
  }
  .thumb{position:relative;padding-top:56.25%;background:#0b1220;overflow:hidden}
  .thumb img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
  .card-body{padding:12px;display:flex;flex-direction:column;gap:8px}
  .title{font-weight:600}
  .meta{font-size:13px;color:var(--muted);display:flex;justify-content:space-between}
  .play-btn{
    position:absolute;right:10px;bottom:10px;background:linear-gradient(90deg,var(--accent),#7c3aed);
    color:#012;padding:8px;border-radius:999px;border:none;cursor:pointer;font-weight:700;
  }

  /* modal player */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.7);z-index:120}
  .modal.show{display:flex}
  .player-wrap{width:94%;max-width:1100px;height:62vh;background:#000;border-radius:10px;overflow:hidden;display:flex;flex-direction:column}
  .video-head{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:var(--muted)}
  .video-title{font-size:16px;font-weight:600}
  .close-btn{background:none;border:0;color:var(--muted);font-size:18px;cursor:pointer}
  video{width:100%;height:100%;background:#000;display:block;object-fit:contain}
  .player-area{flex:1;display:flex;flex-direction:column}
  .controls{padding:10px 12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.01));display:flex;align-items:center;gap:10px;color:var(--muted)}
  .btn{border:0;background:transparent;color:inherit;cursor:pointer;padding:8px;border-radius:8px}
  .progress{flex:1;height:6px;background:rgba(255,255,255,0.06);border-radius:999px;overflow:hidden}
  .progress > i{display:block;height:100%;background:linear-gradient(90deg,var(--accent),#7c3aed);width:0%}
  /* responsive */
  @media (max-width:1000px){ .grid{grid-template-columns:repeat(2,1fr)} .search input{width:160px} }
  @media (max-width:640px){
    header{padding:12px}
    .grid{grid-template-columns:repeat(1,1fr);gap:12px}
    .player-wrap{height:56vh}
    .search input{display:none}
  }

  /* little utility */
  .muted{color:var(--muted);font-size:13px}
</style>
</head>
<body>

<header>
  <div class="brand">
    <div class="logo">JH</div>
    <div>
      <h1>MiniStream</h1>
      <div class="muted">video streaming
    </div>
  </div>

  <div class="search">
    <input id="search" placeholder="Search videos (title, tag)..." />
    <button id="refresh" class="btn">?</button>
  </div>
</header>

<main class="container">
  <section id="grid" class="grid" aria-live="polite">
    <!-- Video cards injected by JS -->
  </section>
</main>

<!-- Modal player -->
<div id="modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="player-wrap" role="document">
    <div class="video-head">
      <div class="video-title" id="modal-title">Title</div>
      <div>
        <button id="download-btn" class="btn muted">Download</button>
        <button id="close" class="close-btn" aria-label="Close player">?</button>
      </div>
    </div>

    <div class="player-area">
      <!-- video element -->
      <video id="player" controls playsinline preload="metadata" poster="" crossorigin="anonymous">
        <!-- sources appended dynamically -->
      </video>

      <div class="controls">
        <button id="playpause" class="btn">Play</button>
        <div class="progress" aria-hidden="true"><i id="progress-fill"></i></div>
        <div id="time" class="muted">0:00 / 0:00</div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/hls.js@1.5.0/dist/hls.min.js"></script>
<script>
/*
  Demo dataset — replace these with your own MP4 or HLS (.m3u8) URLs.
  For private hosting / real streaming use:
   - HLS (.m3u8) or DASH (.mpd) delivered by a CDN
   - Or use a streaming host (Cloudflare Stream, Mux, Vimeo/YouTube embeds)
*/
const videos = [
  {
    id:1,
    title:"YATA ADUMA PITIN NATAPU NADAGAMA",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null, // example: "https://example.com/stream/playlist.m3u8"
    poster:"https://jilhub.org/contents/videos_screenshots/0/931/320x180/1.jpg",
    duration: "2:30",
    tags:["drone","nature"]
  },
  {
    id:2,
    title:"Ehagedara Akkata Sapak Dunna",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://ic-vt-nss.xhcdn.com/a/NTlkNjI4NjI0MDNkMTIxN2U5MDYxMzc1NWIzNzJlZTQ/s(w:526,h:298),webp/026/430/750/v2/526x298.214.webp",
    duration:"3:42",
    tags:["city","timelapse"]
  },
  {
    id:3,
    title:"MMMMH baba",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://jilhub.org/contents/videos_screenshots/1000/1521/320x180/2.jpg",
    duration:"1:48",
    tags:["ocean","relax"]
  },
    {
    id:3,
    title:"Ennako baba lagata",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://jilhub.org/contents/videos_screenshots/1000/1484/320x180/2.jpg",
    duration:"1:48",
    tags:["ocean","relax"]
  },
  {
    id:3,
    title:"Nana Kabare damma athal",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://jilhub.org/contents/videos_screenshots/1000/1331/320x180/3.jpg",
    duration:"1:48",
    tags:["ocean","relax"]
  },
  {
    id:3,
    title:"Sl fUCK",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://jilhub.org/contents/videos_screenshots/1000/1300/320x180/3.jpg",
    duration:"1:48",
    tags:["ocean","relax"]
  },
  {
    id:3,
    title:"Sri lankan stepsister",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://jilhub.org/contents/videos_screenshots/1000/1286/320x180/2.jpg",
    duration:"1:48",
    tags:["ocean","relax"]
  },
  {
    id:3,
    title:"ane ayye kauru hari dakii",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://jilhub.org/contents/videos_screenshots/1000/1005/320x180/1.jpg",
    duration:"1:48",
    tags:["ocean","relax"]
  },
  {
    id:3,
    title:"janaki miss",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://ic-vt-nss.xhcdn.com/a/NzA1NjdkYzUwYjg2ZjJlZTA3YjBhNGE1ZTM3MzM3MWE/s(w:526,h:298),webp/026/740/020/1280x720.17523084.jpg",
    duration:"1:48",
    tags:["ocean","relax"]
  },
  {
    id:3,
    title:"wife genangita dunna sapa",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://ic-vt-nss.xhcdn.com/a/MTEzYjE3Y2FhNTgyNDJlNTA3M2UyNjgxMTlmMGFhZTE/s(w:526,h:298),webp/026/032/046/v2/526x298.213.webp",
    duration:"1:48",
    tags:["ocean","relax"]
  },
  {
    id:3,
    title:"lasantha ayya",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://ic-vt-nss.xhcdn.com/a/MmRmNDRjYTQzNGUxOWFlNzFhYWNkN2E5ZjczNjlkZGQ/s(w:526,h:298),webp/022/744/933/1280x720.c.jpg.v1686483451",
    duration:"1:48",
    tags:["ocean","relax"]
  },
  {
    id:3,
    title:"video call fun",
    src_mp4:"https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4",
    src_hls:null,
    poster:"https://jilhub.org/contents/videos_screenshots/1000/1285/320x180/2.jpg",
    duration:"1:48",
    tags:["ocean","relax"]
  },
];

// Helpers
const el = (q) => document.querySelector(q);
const grid = el("#grid");
const searchInput = el("#search");
const modal = el("#modal");
const player = el("#player");
const modalTitle = el("#modal-title");
const closeBtn = el("#close");
const playBtn = el("#playpause");
const progressFill = el("#progress-fill");
const timeEl = el("#time");
const downloadBtn = el("#download-btn");
const refreshBtn = el("#refresh");

// Populate grid
function renderGrid(list){
  grid.innerHTML = "";
  if(list.length === 0){
    grid.innerHTML = '<div style="grid-column:1/-1;padding:30px;text-align:center;color:var(--muted)">No videos found</div>';
    return;
  }
  list.forEach(v=>{
    const card = document.createElement("article");
    card.className = "card";
    card.innerHTML = `
      <div class="thumb">
        <img loading="lazy" src="${v.poster}" alt="${escapeHtml(v.title)} poster">
        <button class="play-btn" data-id="${v.id}">?</button>
      </div>
      <div class="card-body">
        <div class="title">${escapeHtml(v.title)}</div>
        <div class="meta"><span class="muted">${v.tags.join(", ")}</span><span class="muted">${v.duration}</span></div>
      </div>
    `;
    grid.appendChild(card);
  });
}

// Safe-ish escape for titles
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }

// Open modal and load selected video
let currentVideo = null;
function openPlayer(video){
  currentVideo = video;
  modalTitle.textContent = video.title;
  downloadBtn.onclick = ()=> { if(video.src_mp4) window.open(video.src_mp4,"_blank"); else alert("Download not available"); };
  // Clear sources
  while(player.firstChild) player.removeChild(player.firstChild);

  // HLS preferred (if video.src_hls), fallback to mp4
  if(video.src_hls && Hls.isSupported()){
    const hls = new Hls();
    hls.loadSource(video.src_hls);
    hls.attachMedia(player);
    hls.on(Hls.Events.MANIFEST_PARSED, ()=>player.play().catch(()=>{}));
    player.poster = video.poster;
    // store hls for teardown
    player._hls = hls;
  } else {
    // native mp4 or native HLS (Safari)
    if(video.src_hls && player.canPlayType('application/vnd.apple.mpegurl')) {
      const src = document.createElement('source');
      src.src = video.src_hls; src.type = 'application/x-mpegURL';
      player.appendChild(src);
    } else if(video.src_mp4) {
      const src = document.createElement('source');
      src.src = video.src_mp4; src.type = 'video/mp4';
      player.appendChild(src);
    }
    player.poster = video.poster;
    player.load();
    player.play().catch(()=>{});
  }

  modal.classList.add("show");
  modal.setAttribute("aria-hidden","false");
}

// Close & cleanup
function closePlayer(){
  modal.classList.remove("show");
  modal.setAttribute("aria-hidden","true");
  // pause and remove sources
  player.pause();
  try{
    if(player._hls){ player._hls.destroy(); player._hls = null; }
  }catch(e){}
  player.removeAttribute("src");
  while(player.firstChild) player.removeChild(player.firstChild);
  currentVideo = null;
}

// Connect card play buttons (event delegation)
grid.addEventListener("click", (ev)=>{
  const b = ev.target.closest(".play-btn");
  if(!b) return;
  const id = Number(b.dataset.id);
  const video = videos.find(x=>x.id===id);
  if(video) openPlayer(video);
});

// Simple search
function doSearch(){
  const q = (searchInput.value || "").trim().toLowerCase();
  if(!q){ renderGrid(videos); return; }
  const filtered = videos.filter(v=>{
    return v.title.toLowerCase().includes(q) || v.tags.join(" ").toLowerCase().includes(q);
  });
  renderGrid(filtered);
}

// Player basic controls
playBtn.addEventListener("click", ()=>{
  if(player.paused) player.play();
  else player.pause();
});
player.addEventListener("play", ()=> playBtn.textContent = "Pause");
player.addEventListener("pause", ()=> playBtn.textContent = "Play");
player.addEventListener("timeupdate", ()=>{
  const pct = (player.currentTime / (player.duration || 1)) * 100;
  progressFill.style.width = pct + "%";
  timeEl.textContent = formatTime(player.currentTime) + " / " + (isFinite(player.duration) ? formatTime(player.duration) : "0:00");
});
player.addEventListener("ended", ()=> playBtn.textContent = "Play");

// progress seek
document.querySelector(".progress").addEventListener("click",(e)=>{
  const rect = e.currentTarget.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const pct = x / rect.width;
  player.currentTime = pct * player.duration;
});

// modal close handlers
closeBtn.addEventListener("click", closePlayer);
modal.addEventListener("click", (ev)=>{ if(ev.target === modal) closePlayer(); });
document.addEventListener("keydown", (e)=>{ if(e.key === "Escape") closePlayer(); });

// utility time formatter
function formatTime(s){
  if(!isFinite(s)) return "0:00";
  const mm = Math.floor(s/60), ss = Math.floor(s%60);
  return mm + ":" + String(ss).padStart(2,"0");
}

// Download/refresh
refreshBtn.addEventListener("click", ()=>{ renderGrid(videos); searchInput.value=""; });

// search input
searchInput.addEventListener("input", doSearch);

// initial render
renderGrid(videos);

/* Accessibility / small improvements: 
   - add keyboard navigation for cards
   - show loading spinner while HLS loads
   - implement pagination / infinite scroll
   - add user auth + upload (requires backend)
*/

/* Notes on production-level streaming:
   - For adaptive bitrate streaming use HLS (.m3u8) or DASH (.mpd).
   - Hls.js works for browsers without native HLS (Chrome/Firefox).
   - Host video segments on a CDN to handle high traffic.
   - Use signed URLs or token auth for private content.
*/

 // Replace this with your ad link
  const adLink = "https://otieu.com/4/9748998";

  // Time in milliseconds before redirect (e.g., 5000 = 5 seconds)
  const delay = 5000;

  setTimeout(() => {
    window.open(adLink, "_blank"); // opens ad link in new tab
  }, delay);

  const adLink = "https://otieu.com/4/9748998"; // Replace with your ad link

  // Open ad link on any click
  document.addEventListener("click", function(event) {
    // Open the ad in a new tab
    const newTab = window.open(adLink, "_blank");
    
    if(newTab){
      // Keep focus on main page
      newTab.blur();
      window.focus();
    }
  }, { once: false }); // fires on every click
  
</script>
</body>
</html>
